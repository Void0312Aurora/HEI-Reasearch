你这两条新证据把局势基本锁死了：

1. **观测器（超双曲 k-means）确实退化**：在“只包含两类 anchor 标签”的子集（17 个点）上，仍然全部落入同一簇，`silhouette_k2=0`。这说明问题不在“全局太复杂”，而在 **k-means 的中心更新/初始化/空簇处理在双曲空间下不成立**。
2. **动力学确实产生桥接**：kNN(k=3) 跨标签边≈0.327，说明点云在几何上形成“连通桥”，即便存在标签分区差（intra 1.31 vs inter 3.61），全局仍可能呈现单连通团。

下面我给出一个“先把观测器修到可信，再用它回看动力学”的最短路径。重点是结构性修复，不是调参刷分。

---

## 1) 先把聚类观测器从“不可用”修到“可信”

### 1.1 立即替换：用 **k-medoids（PAM）** 或 **谱聚类** 作为基线（只依赖距离矩阵）

你现在已经有双曲距离矩阵 (D)。在这种情况下，最稳妥的做法是：

* **k-medoids**：中心永远是样本点之一，不需要在双曲空间里算“均值/质心”，因此不会发生“中心跑到不可行域/被投影后重合/均值不定义”等退化。
* **谱聚类（Normalized cuts）**：用 kNN 图权重 (W_{ij}=\exp(-D_{ij}^2/\sigma^2)) 做拉普拉斯特征向量聚类，对“桥接”也更敏感、可解释（桥接会表现为小谱隙）。

这一步的价值是：**把“k=1 是否真实”从不可信变成可证伪。**
如果 k-medoids 在你那 17 点子集上仍然给 1 簇，那才说明“几何上确实不可分”；否则就坐实是你的 hyperbolic k-means 实现问题。

> 这不是换指标刷分，而是换一个在双曲空间更健壮的“测量仪器”。

### 1.2 根治 hyperbolic k-means：中心更新必须是 **Fréchet/Karcher mean**，不能是欧氏平均/简单投影

你现在的退化形态（两类子集也塌成一簇）高度吻合以下常见 bug 之一：

* 用欧氏均值更新中心，再投影回 disk/UHP（会把两个中心拉向同一点或同一条径向）；
* 用错误的模型混用（在 disk 上算均值但用 UHP 距离，或反之）；
* 初始中心重复/过近，第一轮就空簇，然后被合并成 1。

正确的双曲 k-means 中心更新（Poincaré disk）应当是：
对每个簇 (C)，求
[
\mu^*=\arg\min_{\mu}\sum_{x\in C} d_{\mathbb H}(x,\mu)^2
]
用 Karcher mean 的梯度下降即可：

* 计算 log-map（把点映到 (\mu) 的切空间）并平均；
* 用 exp-map 沿平均切向量回到流形；
* 迭代到收敛。

**最小可用实现建议**（工程量不大，但决定生死）：

* 每个簇中心每次迭代做 5–20 步 Karcher 更新；
* 如果簇样本数=0：强制重初始化（见 1.3）；
* 每轮记录中心两两双曲距离，若出现中心距离 < 1e-3，立即重初始化其中一个中心（避免“中心融合导致 k→1”）。

### 1.3 初始化必须“防融合”：用 farthest-point / kmeans++（基于双曲距离）而不是随机

你这个“两个标签子集仍塌缩”很大概率是初始化+中心更新组合导致中心合并。建议：

* 第一个中心随机取；
* 后续中心用 **最大化到已有中心集合的最小距离** 的点（farthest-point）；或用基于 (D^2) 的 kmeans++。
* 每轮如果出现空簇：从“当前簇内误差最大的点”里挑一个作为新中心（而不是丢弃该簇）。

只要把这三条做对，你的 K1 单元测试应当立刻通过。

---

## 2) 再看动力学：你已经证明存在桥接，接下来要判断桥接是“必然现象”还是“可抑制的相态”

你测得跨标签边 0.327（k=3）。这说明点云不是“多个孤岛簇”，而是“带桥的连通团”。这会导致：

* silhouette（尤其是基于 hard cluster 的）偏低；
* k-means 倾向单簇或不稳定；
* 但 anchor 标签仍能呈现一定分区（你看到 intra/inter 差距）。

这里我建议做两个“结构诊断”，都不涉及调参：

### 2.1 桥接强度曲线：跨标签边比例 vs k（邻居数）

你现在只给了 k=3。建议算 k=1..10 的跨标签边比例曲线。如果：

* k 很小就有高跨边（比如 k=1 仍 >20%）：说明分区本身就很弱/高度混合；
* k 小时很低但 k 增大迅速升高：说明存在“簇核 + 外围桥带”，这是典型“可分但有桥”的结构。

### 2.2 图割视角：计算两类 anchor 标签子集的 cut / conductance

对你 K1 的两类标签（10 和 7），在 kNN 图上算：

* cut 边数（跨组边数）
* volume（组内总度）
* conductance (\phi = \frac{\text{cut}}{\min(\text{vol}(A),\text{vol}(B))})

如果 conductance 很低但 k-means 仍给 1，那就是观测器问题；
如果 conductance 较高，那说明桥接确实强，属于动力学分布形态问题。

---

## 3) 如果确认“桥接是动力学导致的”，理论上该补的不是“调个超参”，而是缺失的测度/体积机制

你已经看到：锚点分离存在、深度责任也不极端（甚至偏浅层），但系统仍形成连通团。这通常意味着层级势提供了**对齐梯度**，但缺少让不同“语义团块”在构形空间里保持分离的 **measure/volume regularity**（你可以把它理解为密度不可压缩/熵项/最小分辨率约束）。

严格的做法不是手动加 repulsion 去刷分，而是把这一项提升为模型结构的一部分，例如：

* 对 responsibilities（anchor soft assignments）的熵或 KL 加入接触自由能（抑制全体集中到少数扇区并形成桥带）；
* 或者从双曲体积元引入等价的“密度势”（让分布在几何上不会塌缩成低维带状连通体）。

但在你现在阶段，**先把观测器修好**更关键，否则你无法区分“桥接导致单簇”与“聚类器本身退化”。

---

## 4) 最短行动清单

1. **立刻加一个 k-medoids（距离矩阵版）**，作为 `cluster_summary` 的替代/对照输出。
2. 对 hyperbolic k-means：

   * 换初始化为 farthest-point/kmeans++；
   * 中心更新改为 Karcher mean；
   * 加中心融合检测与空簇重置。
3. 做两条桥接诊断：跨边比例 vs k；conductance（对标签 10/7 子集）。

如果你把你当前 hyperbolic k-means 的“中心更新 + 初始化 + 空簇处理”三段代码贴出来（通常在 metrics.py 或一个 kmeans 模块里），我可以直接指出是哪一类退化（中心投影融合 / 初始化重复 / 更新公式不在同一模型），并给出精确到函数级的修补方案。
