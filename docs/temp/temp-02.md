你这轮把三类“假原因”基本排除了（深层一枝独大、锚点布局不够分离、同/异标签几何差距不存在），所以现在的问题可以更精确地表述为：

> **点云在双曲几何下确实呈现“按 anchor 标签有分区差异”（mean_intra 1.53 vs mean_inter 3.82），锚点之间也有足够分离（deep_anchor_min_dist 0.316），但“无监督簇结构”仍然退化为 1 簇。**
> 这通常意味着：要么你的 **k-means 观测器退化/实现不适配双曲几何**，要么动力学产生了 **“连通桥/连续带状分布”**，使得全局在距离意义上仍是一个连通团（即使局部标签不同）。

下面按“最可能的两个根因”给出检查路径和结构性修正方向（都不是刷分）。

---

## 1) 优先怀疑：**hyperbolic k-means 本身退化**（观测器问题，而非动力学）

你给出的 mean_inter / mean_intra 差距（3.82 vs 1.53）在常规聚类里已经足够让 k>1 出现；但你得到 `best_k=1` 且 `cluster_counts_full=[50]`，这是一个强信号：**k>1 的候选很可能被算法内部“空簇/NaN/重心失真”直接干掉了**，于是扫描只能回落到 k=1。

你现在应该做的不是继续跑主实验，而是做一个**5 分钟的“观测器单元测试”**：

### 单元测试 K1：用当前距离矩阵直接构造一个“显然两簇”的合成数据

* 从你当前 50 个点里选两个锚点标签集合：例如取 `labels_anchor in {A}` 的点做簇1，`labels_anchor in {B}` 的点做簇2（A、B 任选两个出现次数较多的 anchor id）。
* 直接把这两组点喂给你的 hyperbolic k-means（或直接用你内部距离函数）：

  * 若仍然产出 k=1 或频繁空簇：**聚类器实现有硬问题**（初始化、重心更新、空簇重置、距离/重心不在同一模型空间等）。
  * 若能稳定分成两簇：才说明“主实验里的单簇”是真动力学现象。

### 单元测试 K2：检查 k-means 的两个常见退化点

* **初始化是否允许重复中心**：若初始中心重复，第一轮就会空簇，后续若你把空簇丢弃，会导致 “有效 k 变小直至 1”。
* **中心更新是否用欧氏均值**：在双曲空间用欧氏均值更新中心，很容易把中心推到不可行区域/数值不稳定，最终导致“所有点更近某一个中心”。
  这点如果没修好，k-means 的 best_k 基本没有解释力。

> 你已经确认 “深层锚点间有分离空间”，因此如果 k-means 仍给 1，观测器退化的概率非常高。

---

## 2) 如果观测器没问题：那就是动力学产生了“连通桥”，导致全局仍是一个簇

你现在的统计很像下面这种几何图景：

* 点在多个 anchor Voronoi 区域里（所以 `labels_anchor` 多样，sil_anchor>0）
* 但点云在双曲盘上形成一个**连续的带/弧/链**，不同 anchor 标签之间被“桥接”连接起来
  ⇒ k-means 在全局上倾向 1 簇（尤其当点分布是非凸、带状、或各团之间存在密度桥）

你的 mean_inter>mean_intra 并不排除“桥接”：它只说明“同标签平均更近”，但只要存在足够多的“跨标签近邻边”，整个点云仍会是一个连通组件。

### 你可以立刻做的动力学诊断（不改任何参数）

做一个“kNN 连接图”的检查：

* 以双曲距离构图：每个点连到其 k 个最近邻（k=3 或 5）
* 统计跨标签边比例：`P(labels_anchor[i] != labels_anchor[j] for (i,j) in kNN_edges)`
* 看连通分量数：如果几乎总是 1 个连通分量，k-means 退化为 1 是正常现象（它在拟合一个连通团）。

这一步能把“是否桥接”从直觉变成证据。

---

## 3) 结构性修正方向（与理论一致，不是调参）：引入“测度/体积”约束来阻止连通桥与全局收缩

你现在已经看到：深度责任并不极端（浅层 0.647、深层 0.225），锚点也可分离，但动力学仍然“吸引聚集强”。这通常意味着系统缺少一个内生的 **measure-preserving / anti-collapse** 机制。

理论上你不想靠手调 repulsion，那就把它换成更“几何—物理”语言的项，例如二选一：

### 方向 A：对责任分布加“测度熵”约束（推荐，最贴近你现在的 layer_soft_stats）

你已经有 depth/share 的 soft 责任统计了，这说明你内部其实有一个“责任分配机制”。那就把它升级为**真正进入动作/势能的约束**：

* 增加一项：鼓励责任分布不过度集中（例如对 anchor responsibilities 的熵做下界，或对其与先验分布的 KL 做惩罚）
* 这不是“刷分”，而是“构形空间上的测度不塌缩”——可以被解释为信息几何/最大熵原理下的自然项。

它会直接抑制“全体点被连通桥粘成一团”。

### 方向 B：把 (V(q,z)) 的接触耦合真正用起来，令“塌缩态”在接触变量上变得不稳定

你现在已经在接触框架里跑了，完全可以让 **z 的增长/累积**改变势景观，使得：

* 当系统变得过于集中（例如责任熵下降、或点对距离分布收缩）时，势井变浅/温度升高
* 让系统在几何上“解粘”，避免长期停留在单连通团

这比手动改 softmin_scale 更符合你“超参数应由结构决定”的目标：超参数被 z 驱动、由系统状态内生地产生。

---

## 4) 你现在下一步最有效的行动清单

按性价比排序：

1. **先做 k-means 观测器单元测试**（K1/K2）——确认 `best_k=1` 是否可信。
2. **做 kNN 连通桥诊断**：看是否是“一个连通组件 + 标签分区”。
3. 如果确认是动力学问题：优先实现 **责任熵/测度项** 或 **V(q,z) 耦合**（而不是继续在 base_weight/softmin_scale 上手试）。

---


