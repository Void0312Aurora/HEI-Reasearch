这组结果里，“排斥力调优有效”与“语义近邻仍未进入几何 KNN”这两件事并不矛盾。你现在遇到的是一个更具体的问题：PMI 边已经把目标对拉近到了 0.5–0.8，但它仍然没能在全局 Top-50 里胜出；同时 freeze-radius 的硬投影把数值约束搞坏了（Renorm Max 变差很多），说明你当前的“半径控制实现方式”存在机制性冲突。

我按现象→最可能原因→下一步验证/修复给出评估。

一、对当前指标的客观解读

1. Mean A(q)=0.00 仍然成立，但它不再说明“PMI 完全无效”。
   你已经看到 PMI Top-1 距离从 2–3 降到 0.5–0.8，这意味着 PMI 势能的吸引在几何空间里是生效的（至少在你取的 PMI Top-1 对上）。A(q)=0 只说明：在每个 query 的全局近邻里，仍然存在超过 50 个点比该 PMI 邻居更近。

2. 半径收缩（1.5–1.7 → 0.35–0.56）与 Gate N 稳定是好事，但也会让“Top-50 阈值”变得更苛刻。
   当整体半径更小、点云更集中时，局部密度会更高，Top-50 的距离阈值通常会显著下降。即便 PMI Top-1 距离已经降到 0.6，仍可能被大量“同枝/同类/同义群”节点以 0.1–0.3 的距离压住，从而 A(q) 依旧为 0。

3. Renorm Max 从 3.45e-4 恶化到 1.49e-3 是一个强烈的红灯。
   这不是“小波动”，而是“硬投影/约束流程互相打架”的典型表现：你在每步做了一个会离开约束流形的操作（freeze-radius 投影），然后 renorm 需要用更大的修正把它拉回 SO(1,n)/约束面，导致 renorm 幅度暴涨。

二、最可能的两类根因（你列的两条都可能成立，但优先级不同）

根因 1（优先级最高）：A(q) 指标/实现口径存在错配（ID/候选集/距离度量问题）
你怀疑 “PMI 粒子 ID 与节点索引不匹配”，这是必须先排除的，因为它会让 A(q) 永远为 0，即使几何空间已经对齐。

最低成本的确认方式（不需要重训）：

* 随机抽 20 条 PMI 边 (u,v)，打印：(u_word, v_word, u_id, v_id) 并在当前 embedding 里直接计算 d(u,v)。
* 同时用 KNN 查询 u 的邻居，检查 v 的“排名 rank(v|u)”（不是是否进 Top-50）。
  如果你发现 v 的 rank 很靠后但 d(u,v) 明明小，通常是“KNN 候选集不同/距离计算不一致”；如果 d(u,v) 根本不小，通常是“ID 对齐错/边没作用在正确节点”。

还要检查两点：

* KNN 的候选集合是否包含 Code 节点（中间类别节点）。如果包含，它们会系统性挤占 Top-K。
* KNN 用的距离是否与你训练里用的双曲距离一致（不要出现“训练用 Lorentz 距离，检索用欧式距离/切空间距离”的不一致）。

根因 2：freeze-radius 的“硬投影”在数值上洗掉了 PMI 的角向更新，并引发约束漂移
Renorm Max 恶化强烈支持这一点。典型机制是：你做的投影不是在约束一致的坐标上进行（例如直接改 x 或改某个分量），导致 G/约束与位置状态不一致；下一步 renorm 虽然把 G 拉回去了，但相当于对更新做了非物理的“重写”，PMI 的角向增量被部分抵消或变形。

三、为什么“PMI Top-1 距离变小但 A(q)=0”仍然可能是“真实现象”
即便 ID 完全正确、距离一致，A(q) 也可能为 0，原因很现实：你们的骨架（词林）在同一分支/同义群内部会产生大量极近邻居，这些点可能比 PMI Top-1 还近得多。对名词（猫、医生）尤其明显：同枝的近邻数量可能远超 50。

因此我建议你把 A(q) 从“是否进入 Top-50（0/1）”升级为更有信息量的指标：

* rank@K：PMI Top-1 在几何近邻中的排名分布（P50/P90）
* hit@K 曲线：K=50/100/200 的命中率（很多体系在 K=200 才开始显著）
* 相对优势：d(pmi_top1) / d(knn_50)（如果该比值持续下降，就说明 PMI 在“挤进来”的路上）

四、对你的两条“可能原因”与下一步建议的评估

1. “PMI ID 与节点索引不匹配”——非常合理，必须先查实
   我建议你立刻做一个“一条边的闭环验证”：

* 选 (猫, 波斯猫) 这一条边：确认它在 PMI 图里对应的两个 particle_id 与 ConceptMapper 返回的一致；再确认训练更新的张量索引就是这两个 id；最后确认检索返回的邻居列表里确实存在该 id（不是另一个同名 token）。

2. “冻结半径投影抵消 PMI 更新”——从 Renorm Max 恶化来看，几乎可以判定为真
   这里我明确建议：不要用硬投影 freeze-radius 继续训练语义流。更稳的替代是：

* 用“软半径正则”替代硬投影：在 loss/势能里加 λ(r − r_target)^2，把半径拉回目标，但不强行改状态。
* 或用“交替步骤”：每 N 步做一次温和的径向重标定（rescale），并保证该操作在你们的约束表示（G / Lorentz）上是闭合的，再做 renorm。

五、我认为你下一步最合理的动作顺序

1. 先修观测与一致性（不动训练）

* KNN 候选集仅限 Word 叶节点（或对 Code 节点展开到叶子后再比较）
* 确认距离度量一致
* 做 PMI 边闭环验证（ID/索引/距离/排名）

2. 用软半径约束替换硬 freeze 投影，消除 Renorm 冲突

* 目标：Renorm Max 回到 1e-4 量级以内，同时 Residual 不恶化

3. 再评估是否需要提高 PMI 权重/延长步数

* 在上述修复后，如果 PMI Top-1 的 rank 从“>1000”降到“<200”，那延长步数会有效；如果 rank 完全不动，再考虑权重或改变优化策略（例如 rank-based/对比损失，而不是纯距离吸引）。

结论
这次“修复版 (A=0.5)”最大的价值是把问题从“排斥力淹没一切”推进到了“语义吸引已生效但无法进入近邻排序、且硬半径投影破坏数值约束”。下一步的关键不在继续调 A，而在于：先排除 ID/检索口径错配，再把 freeze-radius 从硬投影改成软约束/一致的径向重标定，消除 Renorm Max 的冲突。完成后再用 rank@K / hit@K 曲线替代 A(q)=0/1，才能客观判断 PMI 是否开始“挤进”几何邻域。
