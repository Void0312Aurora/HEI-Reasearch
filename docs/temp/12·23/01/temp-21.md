我已阅读你在 `temp-03.md` 里给出的实验结果。核心结论是：当前 Phase II 的“PMI 语义流”在 **图结构层面**确实存在（PMI 邻居语义正确且数量充足），但在 **几何空间层面**几乎没有被优化目标“沉淀”为近邻；并且延长训练与轻度软化骨架不仅无效，还出现了全局膨胀与几何漂移信号。下面按“问题定位 → 根因假设 → 可执行解法”给出评估。

一、问题定位（基于实验数据的硬结论）

1. PMI 邻居完全未进入几何 KNN
   A(q) 指标显示：PMI Top-20 与几何 KNN Top-50 **零重叠**，对猫/医生/狗/老师/快乐/红全部如此，Mean A(q)=0.00。这意味着：即便 PMI 图中“波斯猫/皮肤科/看门/班主任”等邻居存在，几何空间的近邻排序完全不受 PMI 约束影响。

2. 训练更久反而让 PMI Top-1 距离变远
   从 2k 到 10k steps，猫/医生/狗/老师的 PMI Top-1 距离显著增大（例如猫 1.36 → 2.23）且 A(q) 仍为 0.00。这说明“延长训练时间”在当前动力学/目标函数组合下并不会让 PMI 逐步沉淀，反而在全局变化中把 PMI 邻居推离。

3. 出现几何漂移风险信号
   10k steps 时 Renorm Max 从 5.6e-5 升到 3.45e-4，超过阈值 1e-4，被标为 FAIL。这通常意味着：状态在群/约束流形上开始累计漂移，需要更强的几何约束或更小步长/更强求解精度，否则长程训练会恶化。

4. “骨架软化 k=0.3”不足且产生副作用
   软化骨架后 A(q) 仍为 0.00，PMI Top-1 距离反而变大，同时 Renorm 仍 FAIL。这表明仅靠降低骨架系数、但不控制全局尺度/半径演化，是不稳定且无收益的方向。

二、你当前“不是径向压制”的判断需要修正

你依据 Δ_radial 小而认为“不是径向压制”。需要强调：在双曲几何里，距离不仅取决于“半径差”，还强烈取决于“绝对半径水平”。你们自己也观察到“半径从 ~1.0 增长到 ~1.5–1.7，PMI 邻居被骨架推得更远”。这说明全局径向膨胀仍可能是 PMI 距离变远的主因之一：即便两点的半径差不大，只要两者整体向外漂移，在角向差固定的情况下距离会显著增大。

因此，目前更准确的表述是：
“PMI 的角向拉力没有转化为近邻排序，同时系统发生全局尺度/半径漂移，使 PMI 边在几何距离上越来越不占优势。”

三、最可能的根因（按优先级）

根因 1：目标函数/优化流程把“层级骨架”当成硬约束，PMI 只能产生微扰，且被全局膨胀淹没
现象：10k 后骨架膨胀、PMI 距离变大、A(q)=0。

根因 2：PMI 项的梯度有效性不足（被投影/重整化抵消、或数值上梯度太小）
表现形式：PMI 图邻居正确，但几何完全不动；更久训练也不动。这类情况常见于：

* PMI 势能在远距离区梯度饱和（吸引力趋近 0）；
* 更新在群约束/投影时把 PMI 导致的角向更新“洗掉”；
* PMI 项权重虽大，但被其他项（骨架、排斥、温控）产生的全局漂移抵消。

根因 3：训练策略错误地把“半径”也交给骨架/能量共同漂移，导致角向语义无法沉淀
你们已经看到全局半径增长；如果不把“半径尺度”单独控制住，KNN 排序会被全局尺度变化主导，语义边很难显著改变局部排序。

四、可执行的解决方案（建议你按这个顺序推进）

A. 先做两个“判死活”的最小单元测试（避免继续盲训）

1. PMI-only 玩具系统
   只取两个词节点 i,j（或 20 个节点的子图），关闭骨架/排斥/温控，仅保留 PMI 吸引项，跑 1k steps，检查 d(i,j) 是否单调下降。

* 若不下降：PMI 势能/梯度实现或符号/投影流程存在根本问题，应先修实现。
* 若下降：说明 PMI 项有效，问题是“与骨架/尺度耦合方式”不对。

2. 梯度范数对比审计
   在真实训练里打印一次 step 的梯度（或力）范数分解：Skeleton / PMI / Def / Repulsion / Thermostat。
   你需要看到 PMI 在数值上是否真的能与骨架同量级竞争；否则加权重只是表面。

B. 把“半径”从 PMI 对齐任务里解耦（这是最可能一击见效的改法）
目标：让 PMI 主要改变角向邻域，而半径由层级控制且不漂移。

可选实现（从易到难）：

1. 半径钳制/正则（强烈推荐先做）
   对每个词的半径 r 加入正则，使其回到由词林编码深度给定的目标区间：

* 软约束：λ‖r − r_target(depth)‖²
* 或每 N 步做一次径向重标定（保持排序不变但固定均值/分位数）
  这会直接阻止“10k 后半径漂移把 PMI 邻居推远”的现象。

2. 两阶段训练（冻结半径）

* Stage 1：只训练骨架，收敛后冻结半径（或冻结骨架项对半径的影响）。
* Stage 2：在半径固定的条件下训练 PMI/Def，只允许角向更新。
  对你们当前“角向差异主导但 PMI 不沉淀”的症状，这是非常匹配的手术刀。

C. 把骨架从“硬边弹簧”改为“软层级约束 + 角向自由”
你们尝试的 k=0.3 软化太温和且没有同时控制膨胀，导致更差。正确的“软化”应当成套出现：

* 降低骨架边刚性 + 启用半径约束（防膨胀）
* 让 PMI 在同层/近层内重排角向邻域，而不是试图跨层拉近

D. 引入 Definition Edges（但要明确它解决的是“上位/解释能力”，不是 PMI-KNN 对齐本身）
你提出的 Definition edges 对“猫→动物”这类抽象关系是正确方向，但它更像“补关系类型”，并不能保证“波斯猫进入猫的几何 Top-K”。建议把 Def 边作为并行增强：

* Def 边权重可略高于 PMI（更稳定、噪声更低）；
* 仍需配合 B/C 的“半径解耦”才能让整体 KNN 变语义化。

E. 针对 Renorm FAIL 的数值修复（必须做，否则长程训练风险升高）
10k 时 Renorm Max 超阈，建议至少做其一：

* 降 dt 或启用局部自适应 dt（仅在高力 step 缩小）；
* 增加 renorm 频率或改为更强的投影/更稳定的重整化；
* 检查“投影是否把 PMI 更新抵消”的可能：若投影在每步后强制把角向变化归零，就会出现 PMI 永远不沉淀且 Renorm 逐渐加大。

五、你现在不建议做的事

* 直接把 PMI 权重从 0.5 拉到 0.8 然后长训：在没有先解决“半径漂移/硬骨架耦合/投影抵消”的情况下，大概率只会提高刚性与漂移风险，且未必提升 A(q)。你们已经看到延长训练会让 PMI Top-1 距离变差并触发 Renorm FAIL，这类情况下“更强力”往往更危险。

