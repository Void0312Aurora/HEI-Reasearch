你这组“volume_control”测试给出的信号很一致：你已经解决了一个关键的数值病灶，但几何仍处于“高密度收缩相”，因此 PMI 仍然无法影响 KNN 排序。

一、对结果的客观评估

1. 成功点（重要）

* Renorm Max：1.49e-3 → 3.83e-5（FAIL→PASS）。这基本可以判定：你之前怀疑的“硬投影与更新冲突”确实存在，软半径正则化把这类漂移抑制住了。这个修复是正确的，而且为后续长训扫清了数值障碍。
* Residual P99 稳定在 2e-4 量级：说明隐式求解器在当前张力下余量充足，不是瓶颈。

2. 仍未解决的核心问题

* 密度仍然过高：KNN Top-1 距离仍在 0.04–0.08。对 140k 叶词而言，这意味着“最近邻尺度”极小，近邻排序被大量“伪近邻/同枝近邻”淹没，PMI 拉到 0.6–1.1 仍然必然排到几万名以后。
* 体积扩大幅度几乎没有：半径均值 0.53 → 0.60，1000 步只产生了很小的外扩，仍处在收缩相。你也观察到 PMI 距离变大而 rank 不变或变差，这其实是“全局尺度略变但局部拥挤结构没被打散”的典型表现。

结论：volume_control 解决了“投影漂移”，但“体积/密度控制强度不足”，点云仍挤在太小的可用容积里；因此 PMI 即便生效，也不可能进入 Top-50。

二、为什么 1000 步“几乎看不到体积恢复”

你当前的 volume_control 很可能是“把半径拉向某个目标 r_target”，但：

* r_target 本身仍偏小（0.6 附近），或
* 正则权重 λ 太小、收敛时间常数太大，导致 1000 步只动了 0.07，
* 再加上骨架/其他项在角向上把点压得很紧，导致“即便半径稍增，局部密度仍高”。

注意：你现在真正要控制的不是“均值半径”，而是“邻域尺度/点云密度”。半径只是手段。

三、我建议的解决方案（按优先级，尽量少改代码）

方案 1：把 volume_control 的目标改成“密度 Gate”，直接控制最近邻尺度（最推荐）
新增一个“Crowding Gate/体积熔断器”，把目标从 r 提升为“最近邻距离分位数”：

* 统计每隔 M steps 的 KNN Top-1 距离分布（Word-only 候选集）。
* 设定目标：例如 d_nn1 的 P50 ≥ 0.15（数值你们可根据经验调，但必须显著高于 0.04）。
* 用一个全局缩放因子 s 作用在半径或坐标上（保持角向结构不被洗掉）：

  * 如果 P50 太小：s ← s * 1.05（外扩）
  * 如果 P50 太大：s ← s / 1.02（收缩）
    这种“闭环控制”比固定 r_target 稳健得多，也更贴近你们实际问题。

方案 2：把 r_target 整体上移一个尺度（快速止血）
如果你们现在的深度→半径映射仍然在 0.2–1.0 一类区间，建议整体乘一个尺度因子，例如：

* r_target(depth) := s * r_base(depth)，先用 s=2.0 或 s=2.5 试跑 500–1000 steps
  目标不是“更大就更好”，而是把 KNN Top-1 从 0.04 拉离“拥挤相”。

方案 3：恢复“短程排斥”，但只做防碰撞，不做全局体积控制
你前面把排斥调弱后确实避免了膨胀，但现在的事实是：系统需要一个近距离防粘连机制，否则会持续高密度。

做法：

* 只对 d<ε 的邻居施加排斥（ε 取使得 d_nn1 不会掉到 0.04 的量级）
* 对 d≥ε 直接不排斥或快速衰减
  这样排斥不会再驱动全局半径漂移，但能把极近邻“顶开”，把最近邻尺度抬上来。

方案 4：训练日程改成“三段式”，先恢复体积再谈 PMI 排名
你现在 PMI 距离变大、rank 变差，是因为你在“拥挤相”里强行评估语义排序。建议明确分段：

* Stage A（体积预热 2k–5k steps）：只开 skeleton + volume_control + short-range repulsion，目标是把 d_nn1 P50 拉到目标区间。
* Stage B（语义注入 5k+）：再逐步打开 PMI/Def（你已有退火机制）。
* Stage C（对齐评估）：再看 rank@K / hit@K 曲线，而不是一开始就盯 Top-50。

四、你现在的评估方式也需要升级，否则会误判进展

在“拥挤相”里，A(q)=hit@50 基本必然为 0。你应当同时记录：

* rank(v|u) 的分位数（P50/P90），看是否从 1e5 级别下降到 1e3–1e4
* hit@K 曲线（K=50/100/500/2000）
* 关键比值：d(pmi_top1) / d(knn_50)。只要这个比值持续下降，就说明 PMI 正在“挤进来”。

五、对你当前结论的补充

你说“1000 步不足以恢复体积”是对的，但更关键的是：你现在的控制目标不应是“R 从 0.53 到 0.60”，而是“最近邻尺度从 0.04 上升到可区分的范围”。只要 d_nn1 的分布不抬起来，PMI 就算把边拉到 0.3 也依然会排到几万名之后。


