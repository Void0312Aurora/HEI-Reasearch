# 实验计划：双曲盘上的自组织聚类 (Self-organization on the Poincaré Disk)

## 1. 目标与核心假设
- 目标：在庞加莱盘上用 CCD 主方程验证层级信号驱动的自组织聚类，观测收敛到勒让德子流形 $p=0$、$\nabla_q V_{\text{FEP}}=0$。
- 假设：接触耗散 + Diamond 反馈能让随机点云在负曲率下自发破缺成树状层级（公理 4.3），并表现出“先向中心，后向目标，最后推至边缘”的测地方向性。
- 验证指标：能量单调下降、自由能 $z$ 稳定，$(q,p)$ 相图螺旋坍缩至 $p=0$，在调错阻尼 $\gamma$ 时可见发散或震荡。

## 2. 理论锚点（对应《理论基础-3.md》）
- 几何：$Q=\mathbb{H}^2$ (庞加莱盘)，度量 $g = \frac{4}{(1-|z|^2)^2} I$；全相空间 $M = T^*Q \times \mathbb{R}_z$，接触 1-形式 $\eta = dz - \langle p, dq \rangle$。
- 群作用：$SL(2,\mathbb{R})$ 以 Möbius 变换作用于点集 $a=\{z_k\}$，思维流速 $\xi \in \mathfrak{sl}(2,\mathbb{R})$。
- 主方程：$\frac{d}{dt} (\mathbb{I}(a)\xi) = \operatorname{ad}_\xi^*(\mathbb{I}(a)\xi) + \sum_k (f_k \diamond z_k) - \gamma\,\mathbb{I}(a)\xi$；$\dot z_k = \xi \cdot z_k = v + 2u z_k - w z_k^2$。
- Diamond 力矩：对上半平面表达式 $J_k = \begin{pmatrix} \Re(z_k \bar f_k) & -\tfrac12 \Re(\bar f_k z_k^2) \\ \tfrac12 \Re(\bar f_k) & -\Re(z_k \bar f_k) \end{pmatrix}$。用 Cayley 变换 $z_{\mathbb{H}} = i\frac{1+z_{\mathbb{D}}}{1-z_{\mathbb{D}}}$ 把盘上点映到上半平面后直接套用；避免对梯度做错误的推前/拉回。
- 几何临界阻尼：$\gamma(q) \propto \sqrt{\lambda_{\max}(g(q))} = \frac{2}{1-|z|^2}$，靠近边界耗散变大，中心较小。

## 3. 实验设置
- 点集：$N=50$，初始位置从庞加莱盘按均匀曲率分布采样（半径分布 $r \sim \tanh(\rho/2)$，$\rho$ 按指数体积均匀）。
- 信号源：生成一棵简单层级树（深度 3-4，分支系数 2-3），为每个叶子生成观测特征；用树路径定义理想相似度，得到自由能势 $V_{\text{FEP}}(a,S)$（例如基于负对数似然或层级拉普拉斯势）。
- 力/梯度：先将盘上点映到上半平面 $z_{\mathbb{H}} = i\frac{1+z_{\mathbb{D}}}{1-z_{\mathbb{D}}}$，所有 $V_{\text{FEP}}$ 与黎曼梯度 $\nabla_{\mathbb{H}} V$ 的计算都在上半平面完成；得到的 $f_k$ 直接进入 Diamond 表达式，无需对梯度做 Cayley 推前/拉回。位置更新后再映回盘用于可视化。
- 惯量张量：阶段 1 用固定对角矩阵作为非耦合基线；阶段 2 引入半直积标准惯性 $\mathbb{I}(a) = \sum_{k} \mu_k \rho(z_k)$（每点的动量映射贡献），显式体现“结构影响思维”的耦合。
- 耗散：$\gamma(z) = \gamma_0 \frac{2}{1-|z|^2}$，$\gamma_0$ 作为超参数扫描，验证几何临界阻尼条件。
- 初值：$p$、$\xi$ 取小随机噪声，$z=0$；可设置少量有向初始流以诱导层级轴。

## 4. 仿真流程
- 数据生成：采样层级树与观测；生成目标势 $V_{\text{FEP}}$ 与梯度 oracle。
- 初始化：采样 $z_k$，分配初值 $(\xi,p,z)$，构建 $\mathbb{I}(a)$ 与 $\gamma(z_k)$。
- 积分器：采用接触分裂法（更稳的结构保持）：Step A 解无耗散的哈密顿部分（可用保辛步进处理 Diamond/惯性项），Step B 解纯耗散部分（解析 $e^{-\gamma\Delta t}$ 衰减），组合成接触流；避免直接用通用 RK 破坏几何结构。
- 观测记录：每步记录 $H(t)=\tfrac12\langle\xi,\mathbb{I}\xi\rangle+V_{\text{FEP}}$、$z(t)$、$\|p\|$、$\|\nabla_q V\|$、Möbius 流参数 $(u,v,w)$。
- 可视化：轨迹动画（盘模型上的 $z_k$）、相图 $(q,p)$ 或特征投影（可选以质心或主轴投影定义 $q$）；能量曲线、$z(t)$ 曲线。
- 终止条件：$p$ 范数低于阈值且 $|\Delta H|$、$|\Delta z|$ 均趋近 0，或时间 $t$ 达上限。

## 5. 核心检验 (Sanity Checks)
- 收敛性：$H(t)$ 单调下降，$z(t)$ 收敛；关闭耗散或调小 $\gamma$ 时出现震荡/发散作为对照。
- 相空间：$(q,p)$ 相图呈螺旋内收至 $p=0$ 的勒让德子流形；若出现极限环/混沌则说明 $\gamma$ 或 $\mathbb{I}$ 设置不当。
- 几何效应：轨迹先向盘中心（不确定性增大），再朝目标坍缩，最终被推向边缘的测地方向；对比欧氏版本验证负曲率差异。

## 6. 控制变量与消融
- 去掉 Diamond 项：仅保留惯性与耗散，验证聚类是否失效。
- 去掉接触耗散：验证自由能不再稳定、出现无耗散振荡。
- 变换 $\gamma_0$、步长 $\Delta t$、树深度/分支系数，观察收敛窗口。
- 盘 vs 上半平面表达对比，确认坐标变换的数值一致性。

## 7. 里程碑与交付
- M1：完成双曲采样、层级信号生成、势函数与梯度 oracle。
- M2：实现 Diamond 力矩与接触 Euler-Poincaré 积分器（含耗散）。
- M3：完成观测/可视化管线（能量、$z$、相图、轨迹动画）。
- M4：跑基线与消融实验，收集指标并撰写实验小结。
