DEBUG: Module Loading
DEBUG: Script Entry
=== Phase 19: MNIST Gate-Stability Training ===
Mode: gate_standard, Penalty: 1.0, Drive: 1.0
Loading RawMNIST from ./data/MNIST/raw/train-images-idx3-ubyte.gz...
Loaded 60000 samples.
Epoch 0 [0/938]: Loss=2.3012 (Cls=2.2998, Diss=0.0014)
Epoch 0 [100/938]: Loss=2.3107 (Cls=2.3093, Diss=0.0014)
Epoch 0 [200/938]: Loss=2.2967 (Cls=2.2953, Diss=0.0014)
Epoch 0 [300/938]: Loss=2.3024 (Cls=2.3010, Diss=0.0014)
Epoch 0 [400/938]: Loss=2.3012 (Cls=2.2998, Diss=0.0014)
Epoch 0 [500/938]: Loss=2.3129 (Cls=2.3115, Diss=0.0014)
Epoch 0 [600/938]: Loss=2.3006 (Cls=2.2993, Diss=0.0014)
Epoch 0 [700/938]: Loss=2.3070 (Cls=2.3056, Diss=0.0014)
Epoch 0 [800/938]: Loss=2.2937 (Cls=2.2923, Diss=0.0014)
Epoch 0 [900/938]: Loss=2.3052 (Cls=2.3038, Diss=0.0014)
Epoch 0: Accuracy=10.91%, Gating Events=938
  Metrics: u=0.01, q=0.00, p=0.06
Epoch 1 [0/938]: Loss=2.2963 (Cls=2.2949, Diss=0.0014)
Traceback (most recent call last):
  File "/home/void0312/HEI-Research/HEI/EXP/train_mnist_gate.py", line 244, in <module>
    train_mnist()
  File "/home/void0312/HEI-Research/HEI/EXP/train_mnist_gate.py", line 176, in train_mnist
    logits, energy_seq = model(data)
                         ^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/HEI-Research/HEI/EXP/train_mnist_gate.py", line 97, in forward
    out = self.entity.forward_tensor(self.entity.state.flat, u_ext, dt)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/HEI-Research/HEI/he_core/entity_v4.py", line 100, in forward_tensor
    H_val = self.generator(curr_state, u_ext, weights=chart_weights)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/HEI-Research/HEI/he_core/port_generator.py", line 109, in forward
    H_int = self.internal(state)
            ^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/miniconda3/envs/PINNs/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/void0312/HEI-Research/HEI/he_core/generator.py", line 39, in forward
    K = 0.5 * (p**2).sum(dim=1, keepdim=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
